#HBPOP2022 SNPGenie Prep
#' organizes dataframes used for genetic diversity analysis
#' @param snp_gen_out dataframe generated by SNPGenie 
#' @param popnames text file with sample names in column 1 and population categories in columns 2:#
#' @return dataframe of merged datasets
#' @import dplyr
#' @export

hbpop_snpdf <- function(snp_gen_out, popnames) {
  snp_gen_out <- subset(snp_gen_out, select=-c(1))
  snp_gen_out$product <- gsub('rna-', '', snp_gen_out$product)
  snp_gen_out$NS <- snp_gen_out$piN/snp_gen_out$piS
  snp_gen_out <- na.rm(snp_gen_out)
  snp_gen_out <- snp_gen_out[!is.infinite(snp_gen_out$NS),]
  df <- merge(popnames, merge(data(gb_ncbi_conv), snp_gen_out, by.x="Transcript", by.y="product"))
  return(df)
}